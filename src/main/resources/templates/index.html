<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>프룻프룻 쇼핑몰</title>

    <!--Open Graph-->
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="프룻프룻 Shopping Mall" />
    <meta property="og:title" content="프룻프룻 Shopping Mall" />
    <meta property="og:description" content="프룻프룻 Shopping Mall 입니다." />
    <meta property="og:image" content="/user/img/openGraph.png" />
    <meta property="og:url" content="https://prpr-shopping-mall.co.kr" />

    <!--파비콘-->
    <link rel="icon" href="/user/favicon.ico" />

    <th:block th:insert="~{includes/library}"></th:block>
    <th:block th:insert="~{includes/style}"></th:block>
    <th:block th:insert="~{includes/scripts}"></th:block>
    <th:block th:insert="~{includes/main_scripts}"></th:block>

</head>

<body>

<!-- HEADER -->
<header id="header">
    <div class="inner">

        <a href="/user/index.html" class="logo">
            <img src="/user/img/푸릇푸릇 로고.png" alt="logo" />
        </a>

        <div class="sub-menu">
            <ul class="menu">
                <li>
                    <a href="login">Sign In</a>
                </li>
                <li>
                    <a href="join">Join</a>
                </li>
                <li>
                    <a href="javascript:void(0)">language</a>
                </li>
            </ul>
        </div>

        <ul class="main-menu">
            <li class="item">
                <div class="item__name">HOME</div>
            </li>

            <li class="item">
                <div class="item__name">
                    <a href="search">상품소개</a>
                </div>
            </li>

            <li class="item">
                <div class="item__name">
                    <a href="/user/search.html">구매내역</a>
                </div>
            </li>

            <li class="item">
                <div class="item__name">마이페이지</div>
            </li>

            <li class="item">
                <div class="item__name red">
                    장바구니
                    <span class="material-icons">
                            shopping_cart
                        </span>

                </div>
            </li>
        </ul>

    </div>
</header>

<!-- VISUAL -->
<section id="visual">
    <div class="promotion">
        <div class="swiper">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <img src="/user/img/1.png" alt="1번 슬라이드" />
                </div>
                <div class="swiper-slide">
                    <img src="/user/img/2.png" alt="2번 슬라이드" />
                </div>
                <div class="swiper-slide">
                    <img src="/user/img/3.png" alt="3번 슬라이드" />
                </div>
                <div class="swiper-slide">
                    <img src="/user/img/4.png" alt="4번 슬라이드" />
                </div>
                <div class="swiper-slide">
                    <img src="/user/img/5.png" alt="5번 슬라이드" />
                </div>
                <div class="swiper-slide">
                    <img src="/user/img/6.png" alt="6번 슬라이드" />
                </div>
            </div>
        </div>

        <!-- 슬라이드 좌측, 우측 화살표 -->
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>


        <!-- 슬라이드 페이지버튼 -->
        <div class="swiper-pagination"></div>

    </div>
</section>

<!-- 검색창 -->
<section id="search">
    <div class="inner">

        <!-- 검색창 -->
        <input id="searchKeyword" type="text" placeholder="# 검색어를 입력해주세요.">

        <!-- 돋보기 아이콘 -->
        <span class="material-icons">search </span>

        <!-- 필터 -->
        <div class="buttons">
            <button class="category-btn" value="Spring">봄과일</button>
            <button class="category-btn" value="Summer">여름과일</button>
            <button class="category-btn" value="Fall">가을과일</button>
            <button class="category-btn" value="Winter">겨울과일</button>
<!--            <button>열대과일</button>-->
<!--            <button>하우스과일</button>-->
        </div>

    </div>
</section>

<div id="aside">
    <div class="sidebar">
        <ul>

            <!-- 마이페이지 -->
<!--            <li>-->
<!--                <a href="#">-->
<!--                    <span class="material-symbols-outlined">person</span>-->
<!--                    <p>홍길동님</p>-->
<!--                </a>-->

<!--                <div class="line"></div>-->
<!--            </li>-->

            <li th:if="${loggedIn == true }">
                <a href="#">
                    <span class="material-symbols-outlined">person</span>
                    <p th:text="${loggedInEmail}"></p>
                </a>
                <div class="line"></div>
            </li>

            <li th:if="${loggedIn == false }">
                <a href="#">
                    <span class="material-symbols-outlined">person</span>
                    <p>로그인</p>
                </a>
                <div class="line"></div>
            </li>











            <!-- 장바구니 -->
            <li class="right__cart">
                <a href="#">
                    <span class="material-symbols-outlined">shopping_cart</span>
                    <p>장바구니</p>
                    <div class="cart__count">5</div>
                </a>
            </li>

            <!-- 찜 -->
            <li class="right__favorite">
                <a href="#">
                    <span class="material-icons">favorite</span>
                    <p>찜</p>
                    <div class="favorite__count">3</div>
                </a>

                <div class="line"></div>
            </li>

            <!-- 최근 본 상품 -->
            <li class="last">
                <a href="#">
                    <p>최근 본 상품</p>
                    <ul>
                        <li th:each="entry : ${recentData}">
                            <img th:src="${entry.value}" alt="상품 이미지" th:value="${entry.key}">
                        </li>
                    </ul>
                    <span class="material-symbols-outlined">keyboard_double_arrow_up</span>
                    <p>맨 위로</p>
                </a>
            </li>
        </ul>
    </div>
</div>

<!-- 상품리스트 -->
<section id="products">

    <div class="inner">

        <!-- 상품 리스트 -->
        <ul id="axiosBody">

            <!-- 오렌지 -->
            <!--            class="cart__click"-->
            <li  th:each="p : ${pageInfo.list}" >
                <input class="productInitPrice" type="hidden" th:value="${p.price}">
                <input class="productDiscountPrice" type="hidden" th:value="${p.price * p.rate} / 100">
                <input class="productDiscountedPrice" type="hidden" th:value="${p.price - (p.price * p.rate / 100)}">
                <input class="productDiscount" type="hidden" th:value="${p.rate}">

                <!-- 클릭 시 상세페이지 이동 -->
<!--                <a th:href="@{user/productDetail(productId=${p.id})}">-->
                <a>

                    <!-- 상품 사진 -->
                    <img class="productImage" th:src="${p.file_name}" th:value="${p.id}" alt="상품 이미지" onclick="saveImageInfo(this)">

                </a>
<!--                <div class="icons" >-->
<!--                    &lt;!&ndash; 좋아요 기능 눌렀을때 빨간 하트 아이콘&ndash;&gt;-->
<!--                    &lt;!&ndash; (기본 하트 아이콘은 두번 째 li (과일세트)에 있어요) &ndash;&gt;-->
<!--                    &lt;!&ndash;                        <span class="material-icons red__heart">favorite</span>&ndash;&gt;-->
<!--                    &lt;!&ndash; 좋아요 기능 기본 하트 아이콘&ndash;&gt;-->
<!--                    <a th:id="productLike" th:data-product-id="${p.PRODUCT_ID}" th:if="${sessionId==null}">-->
<!--                        <span class="material-icons material-symbols-outlined">favorite</span>-->
<!--                    </a>-->
<!--                    <a th:id="productLike" th:data-product-id="${p.PRODUCT_ID}" th:if="${sessionId!=null}">-->
<!--                        <span th:if="${p.LIKE_ID != null}" class="material-icons red__heart">favorite</span>-->
<!--                        <span th:if="${p.LIKE_ID == null}" class="material-icons material-symbols-outlined">favorite</span>-->
<!--                    </a>-->

<!--                    &lt;!&ndash; 장바구니 카트 아이콘 &ndash;&gt;-->
<!--                    <a th:id="productCart" th:data-product-id="${p.PRODUCT_ID}">-->
<!--                        <span class="material-symbols-outlined">shopping_cart</span>-->
<!--                    </a>-->
<!--                </div>-->



                <!-- 장바구니 클릭 시 수량 증감버튼 -->
                <!--                <div class="cart">-->
                <!--                    <div class="inner">-->
                <!--                        <button>+</button>-->
                <!--                        <input type="text" value="2">-->
                <!--                        <button>-</button>-->
                <!--                    </div>-->
                <!--                </div>-->

                <!-- 상품 -->
                <div class="txt">
                    <!-- 상품명 -->
                    <div class="title">
                        <span class="productName" th:text="${p.name}"></span>

                    </div>

                    <!-- 상품 가격 -->
                    <div  th:text="${p.price - (p.price * p.rate / 100)}+원">

                    </div>
                </div>

            </li>



        </ul>

    </div>

    <div class="pagination" id="pagination">


        <th:block th:if="${pageInfo.hasPreviousPage}">
            <a th:href="@{/page(pageNum=${pageInfo.prePage}, categoryName=${pageInfo.category_name})}" class="prevBtn" th:value="${pageInfo.prePage}">
                <span class="material-symbols-outlined">chevron_left</span>
            </a>
        </th:block>


        <p class="numbers">
                    <span th:each="pageNumber : ${pageInfo.navigatepageNums}" th:if="${pageNumber <= pageInfo.total}">
                      <a th:text="${pageNumber}" th:href="'#'" class="numberBtn" th:attr="value=${pageNumber}" th:classappend="${pageNumber == pageInfo.pageNum ? 'bold large-text' : ''}"
                         style="font-size: 16px; font-weight: bold;"></a>
                    </span>
        </p>

        <th:block th:if="${pageInfo.hasNextPage}">
            <a th:href="'#'" class="nextBtn" th:value="${pageInfo.nextPage}">
                <span class="material-symbols-outlined">chevron_right</span>
            </a>
        </th:block>
    </div>
</section>


<footer id="footer">
    <div class="inner">
        <h1>
            <img src="/user/img/푸릇푸릇 로고.png" alt="로고">
        </h1>
        <ul>
            <li>
                <a href="#">Policy</a>
            </li>
            <li>
                <a href="#">Terms</a>
            </li>
            <li>
                <a href="#">Customer</a>
            </li>
            <li>
                <a href="#">Contact us</a>
            </li>
        </ul>

        <address>
            <span>(주)콜론비</span>
            <br>
            사업자등록번호 123-12-12345
            <br />
            통신판매업 신고번호 제2023-서울-1234호
            <br>
            대표 한동윤 | 개인정보 책임자 한동윤
            <br>
            서울 특별시 강남구 강남대로 123
            <br>
            <br>
            고객센터: 02-1544-1234
            <br>
            제휴문의: echel@colon-b.com
        </address>

        <p>
            Copyright &copy; 2023 Colon:B. ALL Right reserved.
        </p>
    </div>
</footer>

</body>
<script>
    function saveImageInfo(imgElement) {
        // 이미지 태그로부터 p.file_name과 p.id 값을 읽어옵니다.
        var imageUrl = imgElement.getAttribute('src');
        var product_id = imgElement.getAttribute('value');

        alert( imageUrl);
        alert(product_id);


        // 데이터 객체 생성
        var data = {
            imageUrl: imageUrl,
            product_id: product_id
        };

        axios({
            method: 'post',
            url: '/save-product-info', // 실제 엔드포인트 주소로 대체
            data: JSON.stringify(data), // 데이터를 JSON 문자열로 변환
            headers: {
                'Content-Type': 'application/json'
            }
        }).then(response => {
            if (response.data != null) {
                alert('성공');
            }
        });
    };
</script>

</html>